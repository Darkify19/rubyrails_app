<% provide(:title, "#{@user.name} - Profile") %>

<div class="container mt-4">
  <div class="row">
    <!-- Sidebar with user info -->
    <aside class="col-md-4">
      <section class="user_info text-center">
        <!-- User Gravatar -->
        <%= gravatar_for @user, size: 150, class: 'rounded-circle' %>
        <h2 class="mt-3"><%= @user.name %></h2>
        <p class="text-muted"><%= @user.email %></p>
      </section>
    </aside>

    <!-- Main content area -->
    <div class="col-md-8">
      <section class="user_details">
        <!-- Show reservations for non-admin users -->
        <% unless current_user.admin? %>
          <h3>Your Reservations</h3>
          <% if @user.reservations.any? %>
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Time Slot</th>
                  <th>Table Number</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <% @user.reservations.each do |reservation| %>
                  <tr class="<%= 'table-success' if reservation.status == 'confirmed' %> <%= 'table-danger' if reservation.status == 'cancelled' %> <%= 'table-warning' if reservation.status == 'pending' %>">
                    <td><%= reservation.reservation_date.strftime('%B %d, %Y') %></td>
                    <td><%= reservation.time_slot&.formatted_slot_time || 'N/A' %></td>
                    <td><%= reservation.table.table_number %></td>
                    <td><%= reservation.status.capitalize %></td>
                    <td>
                      <%= link_to 'View', reservation_path(reservation), class: 'btn btn-info btn-sm' %>
                      <%= form_with(model: reservation, method: :delete, local: true, class: 'd-inline') do |form| %>
                        <%= form.submit 'Cancel', class: 'btn btn-danger btn-sm', data: { confirm: 'Are you sure you want to cancel?' } %>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          <% else %>
            <p>No reservations yet.</p>
          <% end %>
        <% else %>

        
        <% end %>
      </section>
    </div>
  </div>
</div>
